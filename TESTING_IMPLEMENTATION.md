# å¾·å·æ‰‘å…‹æ¸¸æˆè‡ªåŠ¨åŒ–æµ‹è¯•å®ç°æ–¹æ¡ˆ

*Stage 2: Game Logic Validation & Test Coverage Implementation*

## æµ‹è¯•æ¶æ„è®¾è®¡ ğŸ§ª

### æµ‹è¯•æŠ€æœ¯æ ˆé€‰æ‹©

- **Jest** - JavaScriptæµ‹è¯•æ¡†æ¶ï¼Œæˆç†Ÿç¨³å®š
- **Supertest** - HTTPæ¥å£æµ‹è¯•ï¼ŒExpressåº”ç”¨æµ‹è¯•åˆ©å™¨  
- **Socket.IO Test Utils** - WebSocketæµ‹è¯•å·¥å…·
- **React Testing Library** - Reactç»„ä»¶æµ‹è¯•æ ‡å‡†
- **AI Bot System** - è‡ªå®šä¹‰æ‰‘å…‹æœºå™¨äººæµ‹è¯•ç³»ç»Ÿ

---

## 1. æ ¸å¿ƒæ¸¸æˆé€»è¾‘æµ‹è¯• ğŸ®

### 1.1 GameLogic.js æµ‹è¯•å¥—ä»¶

#### åŸºç¡€æ¸¸æˆæµç¨‹æµ‹è¯•

```javascript
describe('GameLogic Core Tests', () => {
  // æ‰‹ç‰Œç”Ÿå‘½å‘¨æœŸæµ‹è¯•
  test('å®Œæ•´æ‰‹ç‰Œæµç¨‹', () => {
    // 1. æ–°æ‰‹ç‰Œå¼€å§‹
    // 2. å‘ç‰ŒéªŒè¯ (æ¯äºº2å¼ )
    // 3. ç›²æ³¨ä¸‹æ³¨
    // 4. å››è½®ä¸‹æ³¨ (preflop/flop/turn/river)
    // 5. æ‘Šç‰Œç»“ç®—
  });
  
  // ä¸‹æ³¨ç³»ç»Ÿæµ‹è¯•
  test('ä¸‹æ³¨åŠ¨ä½œéªŒè¯', () => {
    // 1. fold - å¼ƒç‰Œé€»è¾‘
    // 2. check - è¿‡ç‰Œæ¡ä»¶
    // 3. call - è·Ÿæ³¨è®¡ç®—
    // 4. raise - åŠ æ³¨éªŒè¯
    // 5. allin - å…¨ä¸‹å¤„ç†
  });
  
  // è½®æ¬¡ç®¡ç†æµ‹è¯•
  test('è½®æ¬¡å®Œæˆåˆ¤æ–­', () => {
    // 1. æ­£å¸¸è½®æ¬¡å®Œæˆ
    // 2. å•ç©å®¶åœºæ™¯
    // 3. å…¨All-inåœºæ™¯
    // 4. æ··åˆçŠ¶æ€åœºæ™¯
  });
});
```

#### All-inå¤æ‚åœºæ™¯æµ‹è¯•

```javascript
describe('All-in Scenarios', () => {
  test('ä¸¤ç©å®¶All-inå¤šæ¬¡å‘ç‰Œ', () => {
    // 1. è®¾ç½®ä¸¤ç©å®¶All-in
    // 2. éªŒè¯å¤šæ¬¡å‘ç‰Œé€»è¾‘
    // 3. æ£€æŸ¥ç»“æœç»Ÿè®¡
    // 4. åº•æ± åˆ†é…éªŒè¯
  });
  
  test('å¤šç©å®¶All-inè¾¹ç•Œæƒ…å†µ', () => {
    // 1. 3+ç©å®¶All-in
    // 2. è¾¹æ± è®¡ç®—
    // 3. ç­¹ç ä¸ç­‰æƒ…å†µ
    // 4. å¤æ‚åˆ†é…é€»è¾‘
  });
});
```

### 1.2 HandEvaluator.js ç‰Œå‹æµ‹è¯•

```javascript
describe('Hand Evaluation Tests', () => {
  // æ ‡å‡†ç‰Œå‹è¯†åˆ«
  test('æ‰€æœ‰ç‰Œå‹è¯†åˆ«', () => {
    // 1. é«˜ç‰Œ (High Card)
    // 2. ä¸€å¯¹ (One Pair)  
    // 3. ä¸¤å¯¹ (Two Pair)
    // 4. ä¸‰æ¡ (Three of a Kind)
    // 5. é¡ºå­ (Straight)
    // 6. åŒèŠ± (Flush)
    // 7. è‘«èŠ¦ (Full House)
    // 8. å››æ¡ (Four of a Kind)
    // 9. åŒèŠ±é¡º (Straight Flush)
    // 10. çš‡å®¶åŒèŠ±é¡º (Royal Flush)
  });
  
  // è¾¹ç•Œæƒ…å†µæµ‹è¯•
  test('ç‰¹æ®Šç‰Œå‹æƒ…å†µ', () => {
    // 1. A-2-3-4-5 æœ€å°é¡ºå­
    // 2. 10-J-Q-K-A æœ€å¤§é¡ºå­  
    // 3. åŒç­‰ç‰Œå‹æ¯”è¾ƒ
    // 4. Kickeræ¯”è¾ƒé€»è¾‘
  });
});
```

---

## 2. Socket.IOé€šä¿¡æµ‹è¯• ğŸ”Œ

### 2.1 å®æ—¶é€šä¿¡æµ‹è¯•æ¡†æ¶

```javascript
describe('Socket Communication Tests', () => {
  let clientSocket;
  let serverSocket;
  
  beforeAll((done) => {
    // å¯åŠ¨æµ‹è¯•æœåŠ¡å™¨
    server.listen(() => {
      const port = server.address().port;
      clientSocket = Client(`http://localhost:${port}`);
      server.on('connection', (socket) => {
        serverSocket = socket;
      });
      clientSocket.on('connect', done);
    });
  });
  
  test('æˆ¿é—´åˆ›å»ºå’ŒåŠ å…¥æµç¨‹', (done) => {
    // 1. åˆ›å»ºæˆ¿é—´
    // 2. éªŒè¯æˆ¿é—´çŠ¶æ€
    // 3. å…¶ä»–ç©å®¶åŠ å…¥
    // 4. çŠ¶æ€åŒæ­¥éªŒè¯
  });
  
  test('æ¸¸æˆåŠ¨ä½œå®æ—¶åŒæ­¥', (done) => {
    // 1. ç©å®¶ä¸‹æ³¨åŠ¨ä½œ
    // 2. çŠ¶æ€å¹¿æ’­éªŒè¯
    // 3. æ‰€æœ‰å®¢æˆ·ç«¯çŠ¶æ€ä¸€è‡´æ€§
  });
});
```

### 2.2 æ–­çº¿é‡è¿æµ‹è¯•

```javascript
describe('Reconnection Tests', () => {
  test('ç©å®¶æ–­çº¿é‡è¿', () => {
    // 1. æ¨¡æ‹Ÿæ–­çº¿
    // 2. æ¸¸æˆçŠ¶æ€ä¿æŒ
    // 3. é‡è¿çŠ¶æ€æ¢å¤
    // 4. ç»§ç»­æ¸¸æˆèƒ½åŠ›
  });
  
  test('æˆ¿ä¸»æ–­çº¿å¤„ç†', () => {
    // 1. æˆ¿ä¸»æƒé™è½¬ç§»
    // 2. æ¸¸æˆçŠ¶æ€ç»´æŠ¤
    // 3. å…¶ä»–ç©å®¶ä½“éªŒ
  });
});
```

---

## 3. AI Botè‡ªåŠ¨åŒ–æµ‹è¯•ç³»ç»Ÿ ğŸ¤–

### 3.1 æ™ºèƒ½æœºå™¨äººè®¾è®¡

```javascript
class PokerBot {
  constructor(strategy = 'conservative') {
    this.strategy = strategy;
    this.hand = [];
    this.chips = 1000;
    this.decisions = new DecisionEngine(strategy);
  }
  
  // å†³ç­–å¼•æ“
  makeDecision(gameState) {
    const handStrength = this.evaluateHand();
    const position = this.getPosition(gameState);
    const odds = this.calculateOdds(gameState);
    
    return this.decisions.decide({
      handStrength,
      position, 
      odds,
      potSize: gameState.pot,
      currentBet: gameState.currentBet
    });
  }
  
  // ç­–ç•¥æ¨¡å¼
  strategies = {
    conservative: new ConservativeStrategy(),
    aggressive: new AggressiveStrategy(),
    loose: new LooseStrategy(),
    tight: new TightStrategy(),
    random: new RandomStrategy()
  };
}
```

### 3.2 å¤šBotå‹åŠ›æµ‹è¯•

```javascript
describe('Multi-Bot Stress Tests', () => {
  test('6æœºå™¨äººå®Œæ•´æ¸¸æˆ', async () => {
    // 1. åˆ›å»º6ä¸ªä¸åŒç­–ç•¥Bot
    // 2. å®Œæ•´æ¸¸æˆæµç¨‹æ‰§è¡Œ
    // 3. éªŒè¯æ¸¸æˆé€»è¾‘æ­£ç¡®æ€§
    // 4. æ€§èƒ½æŒ‡æ ‡ç»Ÿè®¡
  });
  
  test('é•¿æ—¶é—´æ¸¸æˆç¨³å®šæ€§', async () => {
    // 1. è¿ç»­100æ‰‹ç‰Œæ¸¸æˆ
    // 2. å†…å­˜æ³„æ¼æ£€æµ‹
    // 3. çŠ¶æ€ä¸€è‡´æ€§éªŒè¯
    // 4. é”™è¯¯æƒ…å†µç»Ÿè®¡
  });
  
  test('æç«¯æƒ…å†µæ¨¡æ‹Ÿ', async () => {
    // 1. å…¨All-inåœºæ™¯
    // 2. å¿«é€Ÿè¿ç»­åŠ¨ä½œ
    // 3. ç½‘ç»œå»¶è¿Ÿæ¨¡æ‹Ÿ
    // 4. å¼‚å¸¸æ–­çº¿é‡è¿
  });
});
```

---

## 4. Reactç»„ä»¶æµ‹è¯• âš›ï¸

### 4.1 æ ¸å¿ƒç»„ä»¶æµ‹è¯•

```javascript
describe('ActionButtons Component', () => {
  test('æŒ‰é’®çŠ¶æ€æ¸²æŸ“', () => {
    // 1. ä¸åŒæ¸¸æˆçŠ¶æ€ä¸‹æŒ‰é’®å¯ç”¨æ€§
    // 2. ç­¹ç ä¸è¶³æ—¶çš„UIçŠ¶æ€
    // 3. å›åˆè½®æ¢æ—¶çš„çŠ¶æ€å˜åŒ–
  });
  
  test('ä¸‹æ³¨äº¤äº’é€»è¾‘', () => {
    // 1. æ»‘å—æ§åˆ¶æµ‹è¯•
    // 2. å¿«æ·åŠ æ³¨æŒ‰é’®
    // 3. All-inæŒ‰é’®é€»è¾‘
    // 4. è¾“å…¥éªŒè¯
  });
});

describe('GameRoom Component', () => {
  test('å“åº”å¼å¸ƒå±€', () => {
    // 1. ä¸åŒå±å¹•å°ºå¯¸é€‚é…
    // 2. ç§»åŠ¨ç«¯å…¼å®¹æ€§
    // 3. å…ƒç´ ä½ç½®æ­£ç¡®æ€§
  });
  
  test('ç©å®¶çŠ¶æ€æ˜¾ç¤º', () => {
    // 1. 10ä¸ªåº§ä½ç®¡ç†
    // 2. ç©å®¶ä¿¡æ¯å±•ç¤º
    // 3. å½“å‰å›åˆæŒ‡ç¤º
  });
});
```

### 4.2 çŠ¶æ€ç®¡ç†æµ‹è¯•

```javascript
describe('Zustand Store Tests', () => {
  test('æ¸¸æˆçŠ¶æ€ç®¡ç†', () => {
    // 1. çŠ¶æ€åˆå§‹åŒ–
    // 2. åŠ¨ä½œåˆ†å‘
    // 3. çŠ¶æ€æ›´æ–°éªŒè¯
    // 4. å‰¯ä½œç”¨å¤„ç†
  });
  
  test('Socketé›†æˆæµ‹è¯•', () => {
    // 1. Socketè¿æ¥çŠ¶æ€
    // 2. äº‹ä»¶ç›‘å¬æ³¨å†Œ
    // 3. çŠ¶æ€åŒæ­¥æœºåˆ¶
  });
});
```

---

## 5. è¾¹ç•Œæƒ…å†µæµ‹è¯• ğŸ”

### 5.1 å¼‚å¸¸åœºæ™¯è¦†ç›–

```javascript
describe('Edge Cases & Error Handling', () => {
  test('ç½‘ç»œå¼‚å¸¸å¤„ç†', () => {
    // 1. è¿æ¥è¶…æ—¶
    // 2. æ•°æ®åŒ…ä¸¢å¤±  
    // 3. æœåŠ¡å™¨é‡å¯
    // 4. å®¢æˆ·ç«¯å´©æºƒ
  });
  
  test('ç”¨æˆ·è¾“å…¥éªŒè¯', () => {
    // 1. éæ³•ä¸‹æ³¨é‡‘é¢
    // 2. æ— æ•ˆæˆ¿é—´ID
    // 3. æ¶æ„æ•°æ®æ³¨å…¥
    // 4. è¶…é•¿å­—ç¬¦ä¸²è¾“å…¥
  });
  
  test('å¹¶å‘æ“ä½œå¤„ç†', () => {
    // 1. åŒæ—¶ç©å®¶åŠ¨ä½œ
    // 2. ç«æ€æ¡ä»¶
    // 3. çŠ¶æ€é”å®šæœºåˆ¶
    // 4. æ•°æ®ä¸€è‡´æ€§
  });
});
```

### 5.2 æ€§èƒ½å‹åŠ›æµ‹è¯•

```javascript
describe('Performance Stress Tests', () => {
  test('é«˜å¹¶å‘æˆ¿é—´åˆ›å»º', () => {
    // 1. 100ä¸ªå¹¶å‘æˆ¿é—´
    // 2. å†…å­˜ä½¿ç”¨ç›‘æ§
    // 3. å“åº”æ—¶é—´ç»Ÿè®¡
    // 4. èµ„æºæ³„æ¼æ£€æµ‹
  });
  
  test('å¤§é‡ç©å®¶åŒæ—¶åœ¨çº¿', () => {
    // 1. 500+Socketè¿æ¥
    // 2. æ¶ˆæ¯å¹¿æ’­æ€§èƒ½
    // 3. æœåŠ¡å™¨è´Ÿè½½æµ‹è¯•
  });
});
```

---

## 6. æµ‹è¯•å®æ–½è®¡åˆ’ ğŸ“‹

### 6.1 Phase 1: åŸºç¡€æµ‹è¯•æ¡†æ¶ (Week 1)

```bash
# å®‰è£…æµ‹è¯•ä¾èµ–
npm install --save-dev jest supertest @testing-library/react @testing-library/jest-dom

# é…ç½®Jest
# åˆ›å»ºæµ‹è¯•ç›®å½•ç»“æ„
# ç¼–å†™ç¬¬ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹
```

### 6.2 Phase 2: æ ¸å¿ƒé€»è¾‘æµ‹è¯• (Week 2)

- GameLogic.jså®Œæ•´æµ‹è¯•è¦†ç›–
- HandEvaluator.jsç‰Œå‹æµ‹è¯•
- RoomManager.jsæˆ¿é—´ç®¡ç†æµ‹è¯•
- Socket.IOé€šä¿¡æµ‹è¯•

### 6.3 Phase 3: AI Botç³»ç»Ÿ (Week 3)

- å†³ç­–å¼•æ“å®ç°
- å¤šç­–ç•¥Botå¼€å‘
- è‡ªåŠ¨åŒ–æ¸¸æˆæµ‹è¯•
- æ€§èƒ½åŸºå‡†æµ‹è¯•

### 6.4 Phase 4: å‰ç«¯ç»„ä»¶æµ‹è¯• (Week 4)

- Reactç»„ä»¶æµ‹è¯•
- ç”¨æˆ·äº¤äº’æµ‹è¯•
- çŠ¶æ€ç®¡ç†æµ‹è¯•
- E2Eé›†æˆæµ‹è¯•

---

## 7. æµ‹è¯•è¦†ç›–ç‡ç›®æ ‡ ğŸ¯

### 7.1 ä»£ç è¦†ç›–ç‡æŒ‡æ ‡

- **è¯­å¥è¦†ç›–ç‡**: â‰¥90%
- **åˆ†æ”¯è¦†ç›–ç‡**: â‰¥85%  
- **å‡½æ•°è¦†ç›–ç‡**: â‰¥95%
- **è¡Œè¦†ç›–ç‡**: â‰¥90%

### 7.2 åŠŸèƒ½è¦†ç›–ç‡æŒ‡æ ‡

- **æ¸¸æˆè§„åˆ™**: 100% (æ‰€æœ‰å¾·å·æ‰‘å…‹è§„åˆ™)
- **ç”¨æˆ·äº¤äº’**: â‰¥95% (æ‰€æœ‰æ“ä½œè·¯å¾„)
- **å¼‚å¸¸å¤„ç†**: â‰¥80% (è¾¹ç•Œæƒ…å†µ)
- **æ€§èƒ½åœºæ™¯**: â‰¥70% (å‹åŠ›æµ‹è¯•)

---

## 8. è‡ªåŠ¨åŒ–æµ‹è¯•æµç¨‹ âš™ï¸

### 8.1 CI/CDé›†æˆ

```yaml
# GitHub Actionsé…ç½®
name: Poker Game Tests
on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
      - name: Install dependencies
        run: npm ci
      - name: Run unit tests
        run: npm run test:unit
      - name: Run integration tests  
        run: npm run test:integration
      - name: Run AI bot tests
        run: npm run test:bots
      - name: Generate coverage report
        run: npm run test:coverage
```

### 8.2 æµ‹è¯•æŠ¥å‘Šç³»ç»Ÿ

- **å®æ—¶æµ‹è¯•ç»“æœ**å±•ç¤º
- **è¦†ç›–ç‡æŠ¥å‘Š**ç”Ÿæˆ
- **æ€§èƒ½åŸºå‡†**å¯¹æ¯”
- **å¤±è´¥æ¡ˆä¾‹**è¯¦ç»†æ—¥å¿—

---

## ç»“è®º âœ…

é€šè¿‡å®æ–½è¿™å¥—å®Œæ•´çš„æµ‹è¯•æ–¹æ¡ˆï¼Œæˆ‘ä»¬å°†å®ç°ï¼š

1. **ğŸ® æ¸¸æˆé€»è¾‘å¯é æ€§** - 100%å¾·å·æ‰‘å…‹è§„åˆ™è¦†ç›–
2. **ğŸ¤– AIè‡ªåŠ¨åŒ–éªŒè¯** - æ™ºèƒ½æœºå™¨äººæŒç»­æµ‹è¯•
3. **âš¡ æ€§èƒ½åŸºå‡†å»ºç«‹** - å‹åŠ›æµ‹è¯•å’Œæ€§èƒ½ç›‘æ§
4. **ğŸ”’ è´¨é‡ä¿è¯ä½“ç³»** - è‡ªåŠ¨åŒ–CI/CDæµ‹è¯•æµç¨‹
5. **ğŸ“ˆ ä»£ç è´¨é‡æå‡** - é«˜è¦†ç›–ç‡æµ‹è¯•ä¿æŠ¤

è¿™å°†ä¸ºé¡¹ç›®çš„**é•¿æœŸç¨³å®šæ€§**å’Œ**æŒç»­è¿­ä»£**æä¾›åšå®åŸºç¡€ï¼Œç¡®ä¿æ¯æ¬¡ä»£ç å˜æ›´éƒ½ä¸ä¼šå½±å“æ ¸å¿ƒæ¸¸æˆä½“éªŒã€‚
